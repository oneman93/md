{"version":3,"file":"zero-md.legacy.min.js","sources":["../src/index.js"],"sourcesContent":["export class ZeroMd extends HTMLElement {\n  get src() {\n    return this.getAttribute('src')\n  }\n\n  set src(val) {\n    this.reflect('src', val)\n  }\n\n  get manualRender() {\n    return this.hasAttribute('manual-render')\n  }\n\n  set manualRender(val) {\n    this.reflect('manual-render', val)\n  }\n\n  reflect(name, val) {\n    if (val === false) {\n      this.removeAttribute(name)\n    } else {\n      this.setAttribute(name, val === true ? '' : val)\n    }\n  }\n\n  static get observedAttributes() {\n    return ['src']\n  }\n\n  attributeChangedCallback(name, old, val) {\n    if (name === 'src' && this.connected && !this.manualRender && val !== old) {\n      this.render()\n    }\n  }\n\n  constructor(defaults) {\n    super()\n    this.version = '$VERSION'\n    this.config = {\n      markedUrl: 'https://cdn.jsdelivr.net/gh/markedjs/marked@2/marked.min.js',\n      prismUrl: [\n        ['https://cdn.jsdelivr.net/gh/PrismJS/prism@1/prism.min.js', 'data-manual'],\n        'https://cdn.jsdelivr.net/gh/PrismJS/prism@1/plugins/autoloader/prism-autoloader.min.js'\n      ],\n      cssUrls: [\n        'https://cdn.jsdelivr.net/gh/sindresorhus/github-markdown-css@4/github-markdown.min.css',\n        'https://cdn.jsdelivr.net/gh/PrismJS/prism@1/themes/prism.min.css'\n      ],\n      hostCss:\n        ':host{display:block;position:relative;contain:content;}:host([hidden]){display:none;}',\n      ...defaults,\n      ...window.ZeroMdConfig\n    }\n    this.cache = {}\n    this.root = this.hasAttribute('no-shadow') ? this : this.attachShadow({ mode: 'open' })\n    if (!this.constructor.ready) {\n      this.constructor.ready = Promise.all([\n        !!window.marked || this.loadScript(this.config.markedUrl),\n        !!window.Prism || this.loadScript(this.config.prismUrl)\n      ])\n    }\n    this.clicked = this.clicked.bind(this)\n    if (!this.manualRender) {\n      // Scroll to hash id after first render. However, `history.scrollRestoration` inteferes with this\n      // on refresh. It's much better to use a `setTimeout` rather than to alter the browser's behaviour.\n      this.render().then(() => setTimeout(() => this.goto(location.hash), 250))\n    }\n    this.observer = new MutationObserver(async () => {\n      this.observeChanges()\n      if (!this.manualRender) {\n        await this.render()\n      }\n    })\n    this.observeChanges()\n  }\n\n  connectedCallback() {\n    this.connected = true\n    this.fire('zero-md-connected', {}, { bubbles: false, composed: false })\n    this.waitForReady().then(() => {\n      this.fire('zero-md-ready')\n    })\n    if (this.shadowRoot) {\n      this.shadowRoot.addEventListener('click', this.clicked)\n    }\n  }\n\n  disconnectedCallback() {\n    this.connected = false\n    if (this.shadowRoot) {\n      this.shadowRoot.removeEventListener('click', this.clicked)\n    }\n  }\n\n  waitForReady() {\n    const ready =\n      this.connected ||\n      new Promise((resolve) => {\n        this.addEventListener('zero-md-connected', function handler() {\n          this.removeEventListener('zero-md-connected', handler)\n          resolve()\n        })\n      })\n    return Promise.all([this.constructor.ready, ready])\n  }\n\n  fire(name, detail = {}, opts = { bubbles: true, composed: true }) {\n    if (detail.msg) {\n      console.warn(detail.msg)\n    }\n    this.dispatchEvent(\n      new CustomEvent(name, {\n        detail: { node: this, ...detail },\n        ...opts\n      })\n    )\n  }\n\n  tick() {\n    return new Promise((resolve) => requestAnimationFrame(resolve))\n  }\n\n  // Coerce anything into an array\n  arrify(any) {\n    return any ? (Array.isArray(any) ? any : [any]) : []\n  }\n\n  // Promisify an element's onload callback\n  onload(node) {\n    return new Promise((resolve, reject) => {\n      node.onload = resolve\n      node.onerror = (err) => reject(err.path ? err.path[0] : err.composedPath()[0])\n    })\n  }\n\n  // Load a url or load (in order) an array of urls via <script> tags\n  loadScript(urls) {\n    return Promise.all(\n      this.arrify(urls).map((item) => {\n        const [url, ...attrs] = this.arrify(item)\n        const el = document.createElement('script')\n        el.src = url\n        el.async = false\n        attrs.forEach((attr) => el.setAttribute(attr, ''))\n        return this.onload(document.head.appendChild(el))\n      })\n    )\n  }\n\n  // Scroll to selected element\n  goto(id) {\n    if (id) {\n      const el = this.root.getElementById(id.substring(1))\n      if (el) {\n        el.scrollIntoView()\n      }\n    }\n  }\n\n  // Hijack same-doc anchor hash links\n  clicked(ev) {\n    if (ev.metaKey || ev.ctrlKey || ev.altKey || ev.shiftKey || ev.defaultPrevented) {\n      return\n    }\n    const a = ev.target.closest('a')\n    if (a && a.hash && a.host === location.host && a.pathname === location.pathname) {\n      this.goto(a.hash)\n    }\n  }\n\n  dedent(str) {\n    str = str.replace(/^\\n/, '')\n    const match = str.match(/^\\s+/)\n    return match ? str.replace(new RegExp(`^${match[0]}`, 'gm'), '') : str\n  }\n\n  getBaseUrl(src) {\n    const a = document.createElement('a')\n    a.href = src\n    return a.href.substring(0, a.href.lastIndexOf('/') + 1)\n  }\n\n  // Runs Prism highlight async; falls back to sync if Web Workers throw\n  highlight(container) {\n    return new Promise((resolve) => {\n      const unhinted = container.querySelectorAll('pre>code:not([class*=\"language-\"])')\n      unhinted.forEach((n) => {\n        // Dead simple language detection :)\n        const lang = n.innerText.match(/^\\s*</)\n          ? 'markup'\n          : n.innerText.match(/^\\s*(\\$|#)/)\n          ? 'bash'\n          : 'js'\n        n.classList.add(`language-${lang}`)\n      })\n      try {\n        window.Prism.highlightAllUnder(container, true, resolve())\n      } catch {\n        window.Prism.highlightAllUnder(container)\n        resolve()\n      }\n    })\n  }\n\n  // Converts HTML string into node\n  makeNode(html) {\n    const tpl = document.createElement('template')\n    tpl.innerHTML = html\n    return tpl.content.firstElementChild\n  }\n\n  // Construct styles dom and return HTML string\n  buildStyles() {\n    const get = (query) => {\n      const node = this.querySelector(query)\n      return node ? node.innerHTML || ' ' : ''\n    }\n    const urls = this.arrify(this.config.cssUrls)\n    const html = `<div class=\"markdown-styles\"><style>${this.config.hostCss}</style>${get(\n      'template[data-merge=\"prepend\"]'\n    )}${\n      get('template:not([data-merge])') ||\n      urls.reduce((a, c) => `${a}<link rel=\"stylesheet\" href=\"${c}\">`, '')\n    }${get('template[data-merge=\"append\"]')}</div>`\n    return html\n  }\n\n  // Construct md nodes and return HTML string\n  async buildMd(opts = {}) {\n    const src = async () => {\n      if (!this.src) {\n        return ''\n      }\n      const resp = await fetch(this.src)\n      if (resp.ok) {\n        const md = await resp.text()\n        return window.marked(md, {\n          baseUrl: this.getBaseUrl(this.src),\n          ...opts\n        })\n      } else {\n        this.fire('zero-md-error', {\n          msg: `[zero-md] HTTP error ${resp.status} while fetching src`,\n          status: resp.status,\n          src: this.src\n        })\n        return ''\n      }\n    }\n    const script = () => {\n      const el = this.querySelector('script[type=\"text/markdown\"]')\n      if (!el) {\n        return ''\n      }\n      const md = el.hasAttribute('data-dedent') ? this.dedent(el.text) : el.text\n      return window.marked(md, opts)\n    }\n    const html = `<div class=\"markdown-body${\n      opts.classes ? this.arrify(opts.classes).reduce((a, c) => `${a} ${c}`, ' ') : ''\n    }\">${(await src()) || script()}</div>`\n    return html\n  }\n\n  // Insert or replace HTML styles string into DOM and wait for links to load\n  async stampStyles(html) {\n    const node = this.makeNode(html)\n    const links = [...node.querySelectorAll('link[rel=\"stylesheet\"]')]\n    const target = [...this.root.children].find((n) => n.classList.contains('markdown-styles'))\n    if (target) {\n      target.replaceWith(node)\n    } else {\n      this.root.prepend(node)\n    }\n    await Promise.all(links.map((l) => this.onload(l))).catch((err) => {\n      this.fire('zero-md-error', {\n        msg: '[zero-md] An external stylesheet failed to load',\n        status: undefined,\n        src: err.href\n      })\n    })\n  }\n\n  // Insert or replace HTML body string into DOM and returns the node\n  stampBody(html) {\n    const node = this.makeNode(html)\n    const target = [...this.root.children].find((n) => n.classList.contains('markdown-body'))\n    if (target) {\n      target.replaceWith(node)\n    } else {\n      this.root.append(node)\n    }\n    return node\n  }\n\n  // Start observing for changes in root, templates and scripts\n  observeChanges() {\n    this.observer.observe(this, { childList: true })\n    this.querySelectorAll('template,script[type=\"text/markdown\"]').forEach((n) => {\n      this.observer.observe(n.content || n, {\n        childList: true,\n        subtree: true,\n        attributes: true,\n        characterData: true\n      })\n    })\n  }\n\n  async render(opts = {}) {\n    await this.waitForReady()\n    const stamped = {}\n    const pending = this.buildMd(opts)\n    const css = this.buildStyles()\n    if (css !== this.cache.styles) {\n      this.cache.styles = css\n      await this.stampStyles(css)\n      stamped.styles = true\n      await this.tick()\n    }\n    const md = await pending\n    if (md !== this.cache.body) {\n      this.cache.body = md\n      const node = this.stampBody(md)\n      stamped.body = true\n      await this.highlight(node)\n    }\n    this.fire('zero-md-rendered', { stamped })\n  }\n}\n\ncustomElements.define('zero-md', ZeroMd)\n"],"names":["ZeroMd","_HTMLElement","_inherits","_render","_stampStyles","_buildMd","_super","defaults","_this","_classCallCheck","this","call","version","config","_objectSpread","markedUrl","prismUrl","cssUrls","hostCss","window","ZeroMdConfig","cache","root","hasAttribute","_assertThisInitialized","attachShadow","mode","constructor","ready","Promise","all","marked","loadScript","Prism","clicked","bind","manualRender","render","then","setTimeout","goto","location","hash","observer","MutationObserver","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","observeChanges","stop","key","get","getAttribute","set","val","reflect","value","name","removeAttribute","setAttribute","old","connected","_this2","fire","bubbles","composed","waitForReady","shadowRoot","addEventListener","removeEventListener","_this3","resolve","handler","detail","opts","arguments","length","undefined","msg","console","warn","dispatchEvent","CustomEvent","node","requestAnimationFrame","any","Array","isArray","reject","onload","onerror","err","path","composedPath","urls","_this4","arrify","map","item","_this4$arrify2","_toArray","url","attrs","slice","el","document","createElement","src","async","forEach","attr","head","appendChild","id","getElementById","substring","scrollIntoView","ev","metaKey","ctrlKey","altKey","shiftKey","defaultPrevented","a","target","closest","host","pathname","str","match","replace","RegExp","href","lastIndexOf","container","querySelectorAll","n","lang","innerText","classList","add","highlightAllUnder","_unused","html","tpl","innerHTML","content","firstElementChild","_this5","query","querySelector","concat","reduce","c","_callee3","script","_this6","_args3","_context3","_ref2","_callee2","resp","md","_context2","abrupt","fetch","sent","ok","text","baseUrl","getBaseUrl","status","apply","dedent","t0","classes","t1","t2","links","_this7","_context4","makeNode","_toConsumableArray","children","find","contains","replaceWith","prepend","l","catch","_callee4","_x","append","_this8","observe","childList","subtree","attributes","characterData","_callee5","stamped","pending","css","_args5","_context5","buildMd","buildStyles","styles","stampStyles","tick","body","stampBody","highlight","_wrapNativeSuper","HTMLElement","customElements","define"],"mappings":"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"}